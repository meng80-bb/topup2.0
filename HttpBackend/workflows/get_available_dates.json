{
  "workflow": {
    "name": "get_available_dates_workflow",
    "display_name": "获取可用日期列表",
    "description": "获取数据目录中所有可用的日期列表，并可选择包含已处理日期信息",
    "version": "1.0.0",
    "author": "Topup Team",
    "created_at": "2026-02-24",
    "updated_at": "2026-02-24"
  },
  "execution": {
    "max_parallel_tasks": 1,
    "default_timeout_minutes": 5,
    "retry_on_failure": true,
    "max_retries": 2,
    "retry_delay_seconds": 30,
    "continue_on_error": false,
    "cleanup_on_success": false,
    "cleanup_on_failure": false
  },
  "environment": {
    "python_version": "3.8+",
    "required_modules": [
      "paramiko",
      "python-dotenv",
      "flask",
      "flask-cors",
      "flask-sqlalchemy"
    ]
  },
  "parameters": {
    "required": [
      "user_id"
    ],
    "optional": [
      {
        "name": "include_processed",
        "type": "boolean",
        "default": true,
        "description": "是否包含已处理日期信息"
      },
      {
        "name": "sort_order",
        "type": "string",
        "default": "asc",
        "enum": ["asc", "desc"],
        "description": "排序方式：asc（升序）或desc（降序）"
      }
    ]
  },
  "steps": [
    {
      "id": "step0",
      "order": 1,
      "display_name": "获取可用日期列表",
      "module": "topup_step_v1.step0_get_available_dates",
      "function": "step0_get_available_dates",
      "description": "获取数据目录中所有可用的日期列表，并可选择包含已处理日期信息",
      "timeout_minutes": 5,
      "retry_count": 2,
      "parameters": {
        "include_processed": "include_processed",
        "sort_order": "sort_order"
      },
      "on_failure": {
        "action": "stop",
        "notify": true
      }
    }
  ],
  "notifications": {
    "on_start": {
      "enabled": true,
      "message": "任务 {task_name} 开始执行"
    },
    "on_complete": {
      "enabled": true,
      "message": "任务 {task_name} 执行完成，耗时 {duration}秒"
    },
    "on_failure": {
      "enabled": true,
      "message": "任务 {task_name} 执行失败，错误：{error}"
    },
    "on_step_complete": {
      "enabled": false,
      "message": "步骤 {step_name} 完成"
    }
  },
  "output": {
    "base_dir": "/besfs5/groups/cal/topup/{round}/DataValid",
    "result_format": {
      "all_dates": "array of strings (6-digit dates)",
      "processed_dates": "array of strings (optional, when include_processed=true)",
      "unprocessed_dates": "array of strings (optional, when include_processed=true)",
      "total_count": "integer",
      "processed_count": "integer (optional)",
      "unprocessed_count": "integer (optional)"
    }
  }
}
